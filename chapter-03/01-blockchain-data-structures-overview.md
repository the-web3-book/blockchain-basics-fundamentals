# 作者信息

| 用户名 | 推特 | 真实名字 | 简介 |
|--------|---------|------|--------|
| Seek | seek_web3 | ShiJiang.Guo | DappLink and The Web3 创始人, 曾就职于 Mantle, Bybit, 昆仑万维, HBTC, 币信, ChainUp, 云控蜂核, Achain, Linkeye, Kcash, Biwork, 华夏银行,中信银行|

# 第一节：区块链基本数据结构概览

## 一、Merkle 树（Merkle Tree）

Merkle 树，又称哈希树，是一种自底向上的树形结构，用于高效和安全地验证大规模数据集合中的内容。

### 结构特点

- **叶子节点**：数据（如交易）经过哈希后的结果。
- **非叶子节点**：子节点哈希拼接后再次哈希，逐层向上。
- **Merkle 根节点**：代表所有数据的哈希摘要。

### 区块链中的作用

- 验证某交易是否存在于某个区块（轻节点使用 SPV 机制）。
- 在比特币、以太坊中，交易列表均以 Merkle 树组织。

### 优势

- 任意一笔交易变动将改变整棵树的哈希结构，保障数据不可篡改。
- 可通过 Merkle Proof 快速验证数据存在性，无需遍历全部数据。

## 二、前缀树（Prefix Tree / Trie）

前缀树是一种多叉树结构，每个节点表示一个字符或字节前缀，常用于字符串集合的高效查询。

### 特点

- 每条路径代表一个字符串。
- 相同前缀仅存储一次，节省空间。
- 查询复杂度为 O(k)，k 为键长度。

### 示例用途

- 域名解析（DNS）
- 搜索引擎自动补全
- 区块链中的 Merkle Patricia Trie（MPT）基础结构

## 三、Merkle Patricia Trie（MPT）

MPT 是以太坊状态存储核心结构，结合了 Merkle 树和前缀树的优点。

### 主要特性

| 特性         | 说明 |
|--------------|------|
| 前缀压缩     | 节点共享最长前缀，节省空间 |
| 可验证性     | 节点带有哈希值，可验证内容完整性 |
| 可更新性     | 修改路径仅更新部分节点 |
| 有序性       | 16 进制排序，便于同步和遍历 |

### 节点类型

- **Leaf 节点**：表示完整键及其值。
- **Extension 节点**：压缩的共享前缀。
- **Branch 节点**：包含 16 个子节点及一个可选值。

### 哈希组成

每个节点会经过 RLP 编码并进行哈希，用于构建 Merkle 根。

## 四、MPT 的应用（以太坊为例）

以太坊使用三棵 MPT：

| Trie 名称         | 功能说明 |
|------------------|----------|
| State Trie       | 存储账户状态（地址 → 账户数据） |
| Storage Trie     | 存储合约内部变量（slot → value） |
| Transaction Trie | 存储每个区块中的交易数据 |

### 优势

- 状态验证快速高效，适合轻节点使用。
- 节点同步和状态恢复机制可靠。
- 合约变量存储清晰且可验证。

## 五、布隆过滤器（Bloom Filter）

布隆过滤器是一种空间效率极高的概率型数据结构，可用于判断某元素是否“可能存在”于集合中。

### 工作原理

- 初始化一个比特数组。
- 将元素通过多个哈希函数映射至数组位置，置位为 1。
- 查询时哈希对应位是否全为 1，若否则一定不存在，若是则可能存在（有误判概率）。

### 特点

| 优点                         | 缺点                     |
|------------------------------|--------------------------|
| 空间小，查询快               | 可能误判，无法删除元素   |
| 支持大规模集合查询优化       | 误判概率随元素增加而上升 |

### 区块链中的应用

- 以太坊区块头中的 `logsBloom` 字段。
- 可快速判断某个事件日志是否存在于某区块。


## 六、结构对比总结

| 数据结构         | 核心作用             | 应用系统        | 主要特点                     |
|------------------|----------------------|-----------------|------------------------------|
| Merkle 树        | 验证数据存在性       | 比特币、以太坊   | 高效校验、结构简单           |
| 前缀树（Trie）   | 快速键值查找         | DNS、搜索、以太坊 | 高效查找、支持前缀匹配       |
| Merkle Patricia Trie | 状态验证与更新     | 以太坊           | 可验证、压缩、可局部更新     |
| 布隆过滤器       | 存在性快速判断       | 以太坊事件日志    | 空间高效、可能误判、不可删除 |
