# 作者信息

| 用户名 | 推特 | 真实名字 | 简介 |
|--------|---------|------|--------|
| Seek | seek_web3 | ShiJiang.Guo | DappLink and The Web3 创始人, 曾就职于 Mantle, Bybit, 昆仑万维, HBTC, 币信, ChainUp, 云控蜂核, Achain, Linkeye, Kcash, Biwork, 华夏银行,中信银行|

# 第三节：对称加密和非对称加密


密码学中的加密方式从密钥的数量方向可以分为对称加密和非对称加密，对称加密只使用一把密钥来对数据进行加解密，而非对称加密使用两把密钥来进行加密，分别为公钥和私钥。对称加密和非对称加密有很多非常出名的算法，例如：对称加密比较有名的算法有 DES 和 AES，非对称加密有 RSA 和 ECC。对称加密和非对称加密各有优缺点，那么咱们怎么去利用他们的优缺点呢? 本章我们将分别从理论和实践的角度分析对称加密和非对称加密，让更加容易地理解对称加密和非对称加密。

## 一.对称加密和非对称加密

我们都知道，密码体制有两种: 对称密码体制( 又称为单钥密码体制) 和非对称密码体制( 又称为双钥密码体制或公钥密码体制) 。对称密码体制使用相同的密钥( 秘密密钥) 对消息进行加密/解密，系统的保密性主要由密钥的安全性决定，而与算法是否保密无关。

对称密码体制设计和实现的中心是: 用何种方法产生满足保密要求的密钥以及用何种方法将密钥安全又可靠地分配给通信双方。对称密码体制可以通过分组密码或流密码来实现，它既可以用于数据加密，又可以用于消息认证。非对称密码体制使用公钥加密消息，使用私钥来解密。使用非对称密码体制可增强通信的安全性。

在密码学体系中，对称加密、非对称加密、单向散列函数、消息认证码、数字签名和伪随机数生成器被统称为密码学家的工具箱。其中，对称加密和非对称加密主要是用来保证机密性；单向散列函数用来保证消息的完整性；消息认证码的功能主要是认证；数字签名保证消息的不可抵赖性。这篇文章所要讲诉的就是保证消息的机密性的对称密码和非对称密码。

## 二.对称加密

对称加密又称单密钥加密，整个加密过程中只使用一个密钥。所谓对称其实就是使用一把密钥加密，使用同一把密钥解密。对称加密由于加解和解密使用的是同一个密钥算法，故而在加解密的过程中速度比较快，适合于数据量比较大的加解密。

对称加密的主要有优点就是算法公开、计算量小、加密速度快、加密效率高；但是它也存在强大的缺点，缺点就是密钥协商过程中，一旦密钥泄露，别人可以获取到密钥，这样也能对密文进行解密。另外，每对用户每次使用对称加密算法时，都需要使用其他人不知道的独一密钥，这会使得收、发双方所拥有的钥匙数量巨大，密钥管理成为双方的负担。


如下图：用户 A 使用密钥 X 对消息进行加密，用户 B 使用密钥 X 对消息解密，加解密过程使用的都是同一把密钥

[![Dapplink](./images/encrpyto-1.jpg)](https://github.com/the-web3)


## 三.非对称加密算法

非对称加密又称为公钥密码，该技术是针对私钥密码体制（对称加密算法）的缺陷被提出来的，非对称加密会产生两把密钥，分别为公钥（Public Key）和私钥（Private Key），其中公钥是公开的，任何人都可以知道，私钥是私有的，只有私钥的 Owner 知道私钥。

#### 1.在加密过程中，公钥用于加密，私钥用于解密

[![Dapplink](./images/encrpyto-2.jpg)](https://github.com/the-web3)

- 用户 A 使用用户 B 的公钥对要传输的消息进行加密
- 将消息发给用户 B, 用户 B 使用自己的私钥进行解密消息
- 此过程中，即使消息传输过程中被劫持，消息也是安全的，因为用户 B 的私钥只有用户自己知道，攻击者是无法解密消息的。

#### 2.在签名过程中，私钥用于签名，公钥用于验证签名

[![Dapplink](./images/encrpyto-3.jpg)](https://github.com/the-web3)

- 用户 A 使用自己的私钥对消息进行签名
- 由于公钥是公开的，其他任何用户都可以使用用户 B 的公钥进行签名验证，如果验证成功，说明消息是用户 A 签名的，验证失败，则不是

## 四.对称加密与非对称加密算法安全性依赖

- 非对称加密算法的特点是计算复杂度高，其安全性依赖于算法本身的强度以及密钥的安全性，但算法复杂也导致了其加解密速度较慢。
- 而对称加密算法使用单一密钥，且该密钥必须对通信双方保密，因此其安全性完全取决于密钥的安全传输与存储。
- 相比之下，非对称加密包含两个密钥（公钥与私钥），其中公钥可公开传播，无需像对称加密一样安全传输密钥，显著提升了通信安全性。

## 五.常见的对称加密算法

常用的对称加密算法有 DES、3DES、AES、TDEA、Blowfish、RC2、RC4 和 RC5 等，本节我们将选择 DES 和 AES 两种算法详解讲解

### 1.DES

DES（Data Encryption Standard）是一种对称加密算法，也就是加密和解密使用同一个密钥。

- 输入：64位明文数据（待加密数据）+ 64位密钥
- 输出：64位密文数据（加密后的结果）

DES 加密解密算法最初由美国 IBM 公司研究人员所设计发明，且为第一个公开的商用密码算法标准，自诞生以来便得到了 ISO 的一致认可。DES 是分组密码算法的典型代表，它的明文分组长度为 64bits，密钥长度为 64bits，其中包括有 8bits 的奇偶校验，因此有效密钥长度为 56bits。DES 加密解密算法使用的过程相同，且可以随时均都可以进行变动。它们其中有极少数被认为是易破解的弱密钥，但是很容易抛开它们不使用，因此其自身安全性主要依赖于有效密钥。

DES 算法加密过程首先先对明文分组进行操作，需要加密的明文分为每块 64bits 的固定大小。下图所示左右两部分分别为64bits 的明文分组加密过程和其 16 个子密钥生成的过程。

[![Dapplink](https://github.com/the-web3/cryptography/blob/master/img/des1.jpg)](https://github.com/the-web3)

DES 的核心思想是：对数据进行多轮置换和替代操作，通过混淆数据顺序和改变数据内容，达到安全加密的目的

#### 1.1.DES 核心算法模块

##### 1.1.1.初始置换（IP置换）

DES算法的第一步，就是对输入的64位明文数据做一个重新排序，称为初始置换（IP）。

- IP置换使用固定的置换表（即你提供的8×8的IP表）来重新排列64位数据的顺序。
- 置换不改变数据内容，只改变顺序。
- 置换的目的是打乱数据顺序，提高加密效果。

经过IP置换后的64位数据，被分为左右两个部分：

- 左边32位（称为L0）
- 右边32位（称为R0）

```
  58 50 42 34 26 18 10 2 
  60 52 44 36 28 20 12 4 
  62 54 46 38 30 22 14 6 
  64 56 48 40 32 24 16 8 
  57 49 41 33 25 17  9 1 
  59 51 43 35 27 19 11 3 
  61 53 45 37 29 21 13 5 
  63 55 47 39 31 23 15 7 
```

##### 1.1.2.生成子密钥（密钥处理过程）

DES算法会提前处理用户提供的64位密钥，生成用于16轮加密操作的16个不同的子密钥。

[![Dapplink](https://github.com/the-web3/cryptography/blob/master/img/des2.jpg)](https://github.com/the-web3)

具体步骤：

- PC-1置换：将64位密钥去掉8个用于奇偶校验的位，剩下56位。再将这56位拆分为左右各28位（分别记作C0和D0）。
- 循环左移：分别对 C0 和 D0各自进行一定规则的左移（1位或2位），得到C1和D1。
- PC-2压缩置换：将C1和D1重新合并（共56位），再通过PC-2置换表压缩为48位，这48位即为第一轮的子密钥K1。
- 重复上述循环左移和PC-2置换过程，总共生成16个子密钥（K1～K16）。

每一轮的加密中，都使用不同的子密钥，以增加安全性。

##### 1.1.3.DES核心的16轮加密过程

DES最核心的过程，就是连续进行16轮加密操作。每一轮的步骤相同，如下所述：

每轮的输入：

上一轮的左右两部分数据：Ln-1 和 Rn-1

当轮对应的子密钥：Kn

每轮内部操作：

- 扩展置换（E盒）: 将右半部分Rn-1（32位）通过E盒扩展到48位。这一步实际上将数据扩展并重新排列，目的是方便后续与48位子密钥Kn进行异或运算。
```
  32  1  2  3  4  5 
  4   5  6  7  8  9 
  8   9 10 11 12 13 
  12 13 14 15 16 17 
  16 17 18 19 20 21 
  20 21 22 23 24 25 
  24 25 26 27 28 29 
  28 29 30 31 32  1
```

- 子密钥 Kn 异或运算: 将扩展后的48位数据与当轮的48位子密钥Kn进行异或操作，得到新的48位数据。

- S盒替代（核心保密步骤）
  - 异或后的48位数据，分成8组，每组6位。
  - 每组的6位进入一个S盒中，变成4位输出：

    - S盒是一个4行16列的表格。
    - 输入的6位数据，首位和末位确定S盒的行号，中间4位确定列号。
    - 在S盒中查找到相应位置的数据（4位），完成替代操作。
  
  - 经过8个S盒处理，原本48位的数据被压缩成32位。

- P盒置换:将S盒产生的32位数据再经过一个P盒置换（重新排列顺序），得到32位输出。
- 异或与左右交换: 将P盒置换后的32位数据与本轮左半部分Ln-1进行异或运算，结果成为下一轮的右半部分Rn。
而本轮原始右半部分Rn-1则直接变成下一轮的左半部分Ln。

##### 1.1.4.最终的左右互换与逆初始置换（IP-1）

完成16轮后，左右两部分进行一次互换（注意：只有最后一次16轮结束后才进行互换），形成64位数据。

再将这个64位数据通过IP-1逆初始置换表进行最后一次重新排序（逆置换）：

  - IP-1置换的作用是恢复IP初始置换的乱序效果（但并不会得到原始数据，而是混淆后的密文数据）。
  - 得到最终64位的密文数据。

```
 40 8 48 16 56 24 64 32 39 7 47 15 55 23 63 31
 38 6 46 14 54 22 62 30 37 5 45 13 53 21 61 29
 36 4 44 12 52 20 60 28 35 3 43 11 51 19 59 27
 34 2 42 10 50 18 58 26 33 1 41  9 49 17 57 25
```

#### 1.2.加密与解密的对称性
DES解密的流程和加密流程是完全相同的，只是子密钥的使用顺序反过来：

- 加密时，使用子密钥顺序为：K1 → K2 → ... → K16
- 解密时，使用子密钥顺序为：K16 → K15 → ... → K1

通过这样的设计，加解密算法实现统一、简单。

#### 1.3.总结 DES 算法的安全本质

DES算法的安全性主要依赖于：

- 密钥的安全性（必须严格保密）
- 多轮复杂的置换与替代操作（IP、E盒、S盒、P盒的多次使用）

尽管 DES 算法的结构已经公开，但只要密钥保密，就可以保障信息的安全

#### 1.4.DES 安全性

- DES 算法: 已经破解

#### 1.5.DES 扩展算法

3DES（Triple DES），也叫三重 DES，是对传统的 DES 算法进行 三次连续加密 的一种改进版本，属于对称加密算法。

##### 1.5.1.为什么会有 3DES？

- DES 最初的密钥只有 56 位，后来被发现不够安全，很容易被暴力破解。
- 为了提高安全性，人们提出了对 DES 算法进行多次加密操作，从而出现了 3DES。

##### 1.5.2.3DES 的加密方式（核心原理）

3DES 的核心思想非常简单，就是对明文数据使用 DES 算法连续执行三次加解密操作。

常见的 3DES 模式：EDE模式（加密-解密-加密）

- 使用两个不同密钥 K1 和 K2（也有的使用三个不同密钥 K1、K2、K3）。
- 加密流程：
  - 用密钥 K1 对明文进行 DES 加密。
  - 用密钥 K2 对第一步得到的结果进行 DES 解密。
  - 再次用密钥 K1 对第二步结果进行 DES 加密。

- 完整表示为：
  - 密文 = Encrypt(K1, Decrypt(K2, Encrypt(K1, 明文)))

- 解密流程则完全相反：
  - 明文 = Decrypt(K1, Encrypt(K2, Decrypt(K1, 密文)))

为什么中间要进行一次解密？

- 这样的设计，是为了与传统 DES 算法兼容，并确保安全性更高。
- 如果只连续三次加密（EEE模式），则安全性并不会比两次加密明显提升，而且会降低兼容性。

##### 1.5.3.3DES 密钥长度与安全性

3DES 常见的密钥长度：

- 使用两个密钥 时（K1和K2不同，称为2-Key 3DES）：
  - 总密钥长度为 112 位 (56位 × 2个密钥)，实际安全性大约为 112位。

- 使用三个密钥 时（K1、K2、K3均不同，称为3-Key 3DES）：
  - 总密钥长度为 168 位 (56位 × 3个密钥)，实际安全性可达 168位。

通常情况下，3DES 以两密钥（112位）为主流，已经远高于单个DES（56位）的安全性。

##### 1.5.4.3DES 小结

尽管 3DES 已逐渐被 AES 所取代，但在一些旧的系统中仍然广泛使用，尤其是：

- 银行和金融行业的老旧系统
- 电子支付领域（早期银行卡交易系统）
- 一些需要兼容老系统的政府和企业网络中

简单来说：

- 3DES 就是对 DES 算法连续做三次操作（通常为 加密→解密→加密），提升了密钥长度和安全性。
- 常用的是两密钥模式，密钥长度达到112位，远比单纯的 DES 安全。
- 缺点是运算较慢，现在逐步被速度更快、安全性更高的 AES 所取代。

### 2.AES

#### 2.1.什么是 AES 算法

AES（Advanced Encryption Standard，高级加密标准）是一种对称分组加密算法。

- 对称加密：加密和解密使用同一个密钥。
- 分组加密：将数据分成固定长度的块（AES 为 128 位，即 16 字节），逐块进行加密。

AES 的密钥长度有三种选择，不同长度对应不同的加密轮数：

| 密钥长度	| 加密轮数 |
|:--------:|:------:|
|  128 位  | 10 轮  |
|  192 位	 | 12 轮 |
|  256 位	 | 14 轮 |

#### 2.2.AES 算法的四个核心操作

AES 每轮加密都包含以下四个操作：

- 字节替换（SubBytes）
  - 将每个字节通过S 盒进行非线性查表替换。
  - 每个字节通过行列值在 S 盒查找替换后的新值。
  - 目的：实现数据混淆，使数据变得不可预测。
  - 举例：
    - 原字节为 xy（x 为行，y 为列），
    - S 盒中第 x 行、第 y 列的值即为替换后的结果。

- 行位移（ShiftRows）
  - 对数据矩阵的每一行进行循环左移。
  - 第 1 行不移动，第 2 行左移 1 位，第 3 行左移 2 位，第 4 行左移 3 位。
  - 目的：进一步打乱数据排列。
  - 示意图

```
  原矩阵:           行位移后的矩阵:
[A1 B1 C1 D1] → [A1 B1 C1 D1] (不动)
[A2 B2 C2 D2] → [B2 C2 D2 A2] (左移1位)
[A3 B3 C3 D3] → [C3 D3 A3 B3] (左移2位)
[A4 B4 C4 D4] → [D4 A4 B4 C4] (左移3位)
```

- 列混合（MixColumns）
  - 把矩阵每一列的 4 个字节看作一个整体进行数学运算（乘以一个固定多项式并取模）。
  - 实质是对列内数据进行混合，让每个字节受到其它字节的影响。
  - 目的：少量数据改变即可快速扩散，提高安全性。

- 轮密钥加（AddRoundKey）
  - 将当前状态矩阵与对应的轮密钥进行异或（XOR）运算。
  - 每轮轮密钥由原始密钥通过密钥扩展算法生成。
  - 目的：让密钥参与运算，实现加密效果。

#### 2.3.AES 加密完整流程（128 位密钥）

完整的 AES 加密过程：

- 初始轮：
  - 明文状态矩阵与第一个子密钥进行轮密钥加（XOR）运算。

- 主循环轮（第 1 到 9 轮）： 每一轮进行以下 4 个步骤：
  - 字节替换（SubBytes）
  - 行位移（ShiftRows）
  - 列混合（MixColumns）
  - 轮密钥加（AddRoundKey）

- 最终轮（第 10 轮）：

  - 字节替换（SubBytes）
  - 行位移（ShiftRows）
  - 轮密钥加（AddRoundKey）

- 注意：最后一轮不执行列混合（MixColumns）。
  - 输出密文（128 位）

#### 2.3.AES 解密完整流程（逆操作）

AES 解密过程，就是 AES 加密过程的完全逆操作：

- 字节替换（SubBytes）→ 逆字节替换（Inverse SubBytes）
- 行位移（ShiftRows）→ 逆行位移（Inverse ShiftRows）（右移）
- 列混合（MixColumns）→ 逆列混合（Inverse MixColumns）
- 轮密钥加（AddRoundKey）→ 轮密钥加（本身为逆运算）

解密详细过程：

- 初始轮密钥加（使用第10轮密钥）
- 主循环轮（9 轮）： 每轮依次进行：

  - 逆行位移
  - 逆字节替换
  - 轮密钥加
  - 逆列混合

- 最终轮：

  - 逆行位移-
  - 逆字节替换
  - 轮密钥加（初始轮密钥）

- 恢复出明文（128 位）

#### 2.4.AES 算法的特点与优势

AES 算法：就是将数据分成若干个 128 位的小块，每个小块经过多轮的字节替换、行移位、列混合和密钥异或等操作，彻底打乱数据，实现安全加密。

- 高安全性：抵抗了多种密码攻击，安全性极高。
- 高效率：实现简单、运算速度快，适合硬件和软件实现。
- 标准化：被全球广泛使用，特别在金融、通信领域。


## 六.常见的非对称加密算法

常用的非对称加密算发有 RSA、Elgamal、背包算法、Rabin、D-H、ECC（椭圆曲线加密算法）等。

### 1.RSA 算法

RSA 算法是一种迄今为止理论上比较成熟和完善的公钥密码体制，是非对称密码体制的典型代表。在网络、信息安全等许多方面都使用 RSA 算法，特别是 RSA 算法典型应用在通信中的数字签名，可实现对手的身份、不可抵赖性验证。在身份认证、信息安全、电子商务中有着广泛的应用前景。

#### 1.1.RSA 算法流程

- 生成密钥：
  - 选择两个大素数 p 和 q。
  - 计算 n = p × q。
  - 计算欧拉函数 φ(n) = (p-1)(q-1)。
  - 选取一个整数 e，满足 1 < e < φ(n) 并且 e 与 φ(n) 互质。
  - 计算 e 的逆元 d（模逆运算）：d × e ≡ 1 mod φ(n)。
  - 公钥为 (e, n)，私钥为 (d, n)。

- 加密过程：
  - 明文 m 经过加密，密文为：c = m^e mod n

- 解密过程：
  - 密文 c 经过解密，明文为：m = c^d mod n

- 签名流程：
  - 使用发送者的私钥 d 对消息或消息摘要（hash）进行签名：
  - 签名 s = m^d mod n

- 验证签名流程：
  - 接收者使用发送者的公钥 (e, n) 验证签名的真实性：
  - 验证过程：m = s^e mod n
  - 若得到的消息或消息摘要与原始消息或摘要一致，则签名有效。


#### 1.2.RSA 算法特点

- 安全性高
  - RSA 安全性依赖于大整数的分解难度（即质因数分解困难）。
  - 使用足够大的密钥长度（如1024位、2048位），破解难度极大。

- 非对称密钥
  - RSA 有两把密钥：公钥（公开）和私钥（保密）。
  - 公钥加密的信息，只能用私钥解密；反之亦然。

- 应用广泛，成熟可靠：RSA 经过长时间的考验，在众多领域广泛使用，可靠性高。

- 加解密速度慢：与对称加密算法（如AES）相比，RSA计算量大，速度较慢。

#### 1.3.RSA 算法的主要应用场景

- 数字签名（身份认证和防止抵赖）
  - 发送者用自己的私钥对信息生成签名，接收者用发送者的公钥验证签名
  - 适用于电子商务合同、电子邮件、数字证书等，保证发送者的身份真实性和不可否认性

- 安全通信中的密钥交换
  - 通常不直接加密大量数据，而是用于传输一个随机生成的对称密钥。
  - 对称密钥（如AES的密钥）再用来快速地加解密通信内容。

- HTTPS/SSL 协议中的身份验证和密钥交换
  - RSA 是 SSL/TLS 协议中最早使用的公钥算法之一，用于身份认证和安全密钥协商
  - 浏览器访问HTTPS网站时，服务器通过RSA算法完成身份认证和安全的密钥传输

- 软件签名和证书签发：
  - 软件开发者或发布者使用 RSA 算法签名软件包，用户可用公钥验证软件的真实性
  - CA（证书颁发机构）使用RSA算法签署数字证书，保证证书的真实性

- 电子商务与网络支付：RSA 广泛用于银行系统的网上支付、电子转账，保证交易数据和身份的安全可靠。

#### 1.4.简单总结

- RSA 主要用在数字签名、身份认证、安全密钥传输上，可靠且广泛应用
- 因为速度较慢，一般不直接加密大文件，而用来保护少量关键数据

### 2.ECC 算法

- ECC（Elliptic Curve Cryptography）：一种基于椭圆曲线数学理论的**非对称加密算法体系**。
- 常见代表算法有：
  - ECDSA：基于 Weierstrass 椭圆曲线的数字签名方案。
  - EdDSA（Ed25519）：基于 Twisted Edwards 曲线的签名算法，属于 Schnorr 签名变种。
  - X25519：基于 Curve25519 的密钥交换算法（非签名）。

#### 2.1.密钥生成过程对比

| 项目 | ECDSA（如 secp256k1） | EdDSA（如 Ed25519） |
|------|------------------------|----------------------|
| 私钥 | 随机生成 256-bit 整数 d | 随机生成 32 字节种子 sk |
| 公钥 | Q = d · G（椭圆曲线点） | 公钥 A = a · B，a 来自对 sk 的 SHA-512 处理 |
| 公钥格式 | 通常为 (x, y)，压缩为 33 字节或未压缩 65 字节 | 仅保存压缩形式（32 字节） |

#### 2.2.签名与验证流程

##### 2.2.1 ECDSA 
- ECDSA 签名流程
  - 将消息 `M` 进行哈希：`e = Hash(M)`
  - 随机生成 `k`，计算 `R = k · G`，取 `r = R.x mod n`
  - 计算 `s = k⁻¹(e + r·d) mod n`
  - 输出签名 `(r, s)`

- ECDSA 验证流程
  - 验证 `r, s` 是否在合法范围内
  - 计算 `w = s⁻¹ mod n`
  - 计算 `u1 = e·w mod n`，`u2 = r·w mod n`
  - 计算 `P = u1·G + u2·Q`，若 `P.x mod n == r`，验证成功

##### 2.2.1 EdDSA 

- EdDSA（Ed25519）签名流程
  - 取私钥 `sk`，做 SHA-512 得到 `a` 和 `prefix`
  - 计算 `r = Hash(prefix || M)`
  - 计算 `R = r·B`
  - 计算 `k = Hash(R || A || M)`
  - 计算 `s = r + k·a mod L`
  - 输出签名 `(R, s)`（64 字节）

- EdDSA 验证流程
  - 解析公钥 `A` 和签名 `(R, s)`
  - 计算 `k = Hash(R || A || M)`
  - 验证 `s·B == R + k·A`


#### 2.3.加密与解密能力

| 功能 | ECDSA | EdDSA |
|------|-------|--------|
| 加密/解密 | 不支持（需结合 ECDH） | 不支持（结合 X25519 实现密钥交换） |
| 密钥交换 | 可与 ECDH 结合使用 | 通常配合 X25519 使用 |
| 常见用法 | 数字签名 + 配合 ECDH 加密 | 数字签名 + X25519 实现通信加密 |


#### 2.4.算法机制差异点

| 比较项 | ECDSA | EdDSA（Ed25519） |
|--------|--------|------------------|
| 签名是否确定性 |  否，依赖随机数 `k` |  是，签名由私钥和消息决定 |
| 随机数安全性要求 | 高，`k` 泄露会导致私钥泄露 | 无需外部随机数，天然抗泄露 |
| 哈希算法 | 可选（如 SHA-256） | 固定使用 SHA-512 |
| 曲线类型 | Weierstrass（secp256k1） | Twisted Edwards（Curve25519） |
| 签名长度 | 可变（约 64~72 字节） | 固定 64 字节 |
| 计算效率 | 高（依赖实现优化） | 更高，适合软件实现 |
| 抗侧信道攻击 | 易受影响 | 更强，不依赖模逆或分支判断 |
| 多签名支持 | 支持但较复杂 | 易于扩展聚合签名、多签名等 |


#### 2.5.区块链与应用场景

| 场景 | ECDSA（secp256k1） | EdDSA（Ed25519） |
|------|--------------------|------------------|
| 比特币 | 使用 | 没有使用 |
| 以太坊 | 使用 | 支持 EdDSA 类型合约扩展） |
| Solana | 没有使用 | 使用 Ed25519 |
| Cardano、Monero、IOTA | 没有使用 | 使用 Ed25519 |
| SSH 登录 | 支持 ECDSA 密钥 | 推荐使用 Ed25519 密钥 |
| TLS 证书 | 常用 P-256 签名证书 | 支持（OpenSSL 1.1.1+） |
| Libsodium / NaCl 加密库 | ⚠ 较少支持 | 默认支持 Ed25519 / X25519 |


#### 2.6.小结

- 关注 **安全性、性能、确定性签名**，推荐使用 **Ed25519（EdDSA）**
- 若需要与 **比特币等传统区块链兼容**，使用 **ECDSA（secp256k1）**
- Ed25519 更适合现代应用、嵌入式设备、硬件钱包、通信协议等

## 七.混合加密：对称加密与非对称加密的实际应用场景

混合加密，顾名思义，是在实际应用中将对称加密和非对称加密两种技术结合起来使用的方式。我们知道，虽然非对称加密在安全性方面有天然优势，但其加解密速度通常比对称加密慢上数千倍。因此，为了兼顾效率与安全，现代通信系统普遍采用“混合加密”的设计理念，取长补短，实现最优的加密效果。

### 1.对称加密的特点与应用问题

对称加密（Symmetric Encryption）又称为“单钥加密”，加密与解密使用同一密钥，通信双方需要共享这组密钥才能完成数据加密和解密。

- 优点：
  - 算法简单，计算效率高，适合大数据量加密；
  - 在闭环或可信网络中非常实用，常用于实际数据传输。

- 缺点：
  - 密钥分发问题：通信双方需通过非面对面方式协商密钥，过程易被窃听；
  - 密钥管理负担重：每对通信者都需要唯一密钥，系统中密钥数量成指数级增长；
  - 无法进行身份认证：仅能加密数据，无法确认发送者身份，也无法验证数据完整性。

### 2.非对称加密的特点与限制

非对称加密（Asymmetric Encryption）使用一对密钥，即公钥和私钥。公钥可以公开传播，私钥则由用户私密保管。

- 两种典型使用方式：
  - 保密通信：发送方使用接收方的公钥加密，只有持有私钥的接收方可解密；
  - 数字签名：发送方使用自己的私钥加密（签名），接收方用其公钥验证，确认信息来源与完整性。

- 优点：
  - 避免了对称加密中的密钥分发问题；
  - 支持身份认证、数字签名等机制，增强数据的可信性；
  - 一对密钥可支持与多个通信对象的安全通信。

- 缺点：
  - 加解密过程计算复杂、速度慢；
  - 不适合直接加密大数据量内容，仅适合小规模数据或密钥信息。

### 3.混合加密的实际应用方式

为了综合两种加密算法的优势，现实中常采用如下混合加密策略：

- 会话密钥加密：通信双方首先使用非对称加密（如 RSA）传输一个临时生成的对称密钥；
- 数据传输阶段：大规模的数据通信部分使用对称加密算法（如 AES）进行加密，提升效率；
- 身份验证与签名：同时结合非对称加密技术进行身份认证与消息签名，保障数据完整性与来源真实性。

这种方式在 HTTPS、VPN、安全邮件（如 PGP）、区块链钱包等系统中被广泛采用，既保证了加密通信的安全性，也兼顾了通信效率和可扩展性。

混合加密是现代加密通信的主流方案，通过非对称加密保障密钥传输的安全性，再通过对称加密提高数据传输效率，有效解决了单一加密方式在实际应用中的局限性。它将两种算法的优势融合在一起，成为可信通信、安全支付、物联网、区块链等领域的核心安全保障手段。

## 八.本节总结

本节系统讲解了密码学中的两大核心加密机制——对称加密与非对称加密，并结合区块链实际应用场景，构建了清晰的加密安全知识框架。

在概念上，对称加密是使用同一把密钥完成数据的加密与解密，具有速度快、计算资源消耗低的优势，适用于大数据量加密。典型算法包括 DES、3DES 和 AES，广泛应用于传统信息系统、支付网关、数据传输通道等场景。

非对称加密则使用一对密钥（公钥 + 私钥）进行加解密操作，公钥公开，私钥保密。它支持数字签名、身份认证、密钥交换等高级安全能力。代表算法有 RSA 和 ECC（椭圆曲线密码学），特别是 ECC 在安全性与性能之间取得了极佳平衡。

在区块链领域，非对称加密是系统安全的核心基石。每个钱包账户本质上就是一对密钥，私钥即身份，公钥即地址。例如，比特币和以太坊使用的是 ECDSA（基于 secp256k1 椭圆曲线）的签名算法，而 Solana、Cardano、Polkadot 等新一代区块链项目则采用了 Ed25519，这种算法更快、更小、更安全，极其适合区块链中节点签名、验证交易、智能合约交互等性能要求高的场景。

然而，非对称加密虽然安全，但计算开销大、效率较低。这时就引出了现代密码系统的主流模式——混合加密。混合加密的核心思想是：用非对称加密来加密一次性的对称密钥，再使用对称加密对实际的数据进行快速加密传输。这种组合方式广泛应用于 HTTPS 协议、区块链钱包通信、跨链桥消息认证、链下数据隐私保护等系统中。

例如，在区块链中，区块广播、链下签名授权、跨链通信、去中心化存储（如 IPFS + Filecoin）等应用场景中，为了实现高效率、强安全的消息传递，通常采用“非对称 + 对称”的混合加密设计。比如用户使用公钥加密会话密钥，再用 AES 加密交易信息，最后发送给智能合约或节点网络，从而既保证隐私性，又确保性能。

本节还详细讲解了 DES、3DES、AES 的具体加解密流程与轮结构，深入解析了 RSA 和 ECC 的密钥生成、加密、解密、签名和验签逻辑，为理解加密技术在实际工程中的应用提供了扎实基础。

总结而言，无论是在 Web 安全、金融科技，还是在去中心化网络和区块链生态中，对称加密 + 非对称加密 + 哈希函数 + 签名算法，共同构成了“现代密码学工具箱”。了解它们的底层原理、算法差异、使用限制与组合方式，是每一位 Web3 工程师、安全开发者、区块链从业者的必修课。

只有真正理解密码学的本质，才能更安全地构建可信系统，开发真正意义上的去中心化应用（DApps）与安全协议。
